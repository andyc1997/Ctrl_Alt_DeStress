import pandas as pd

from botocore.client import BaseClient
from io import StringIO

def s3_write_csv(s3: BaseClient, df: pd.DataFrame, bucket_name: str, object_key: str):
    # Convert DataFrame to CSV and upload to S3
    csv_buffer = StringIO()
    df.to_csv(csv_buffer, index=False)
    s3.put_object(Bucket=bucket_name, Key=object_key, Body=csv_buffer.getvalue())

def s3_read_csv(s3: BaseClient, bucket_name: str, object_key: str) -> pd.DataFrame:
    # Read CSV from S3 and return as DataFrame
    csv_obj = s3.get_object(Bucket=bucket_name, Key=object_key)
    body = csv_obj['Body'].read().decode('utf-8')
    return pd.read_csv(StringIO(body))